<script setup>
import Icon from '@/components/Icon.vue'
import { computed } from 'vue'
import { useStore } from 'vuex'
import { mdiCog, mdiArrowDownRight } from '@mdi/js'
const store = useStore()
const employeesByEmail = computed(() => store.state.employees.employeesByEmail)

defineProps({
  projects: {
    type: Array,
    default: () => []
  }
})

</script>

<template class="w-full">
  <div v-for="(value, index) in projects" :key="index">
    <p class="text-7xl text-gray-400 underline font-extralight my-10 dark:text-gray-100">{{ value.dep }}</p>
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 truncate">
      <template v-for="(project, pindex) in value.items" :key="pindex">
        <div
          class="flex items-start bg-white dark:bg-gray-700 rounded-xl shadow-md hover:shadow-lg h-30 p-3"
        >
          <div>
            <div class="flex items-start justify-between">
              <p class="font-light cursor-pointer">{{ project.name }}</p>
              <icon
                :path="mdiCog"
                size="18"
                class="text-gray-400 cursor-pointer"
              />
            </div>
            <div class="flex items-center" v-if="project.children && project.children.length">
              <p
                class="font-light text-xs"
              >
                Дочерних: {{ project.children.length }}
              </p>
              <icon
                :path="mdiArrowDownRight"
                size="18"
                class="text-gray-400 cursor-pointer"
              />
            </div>
              <div v-if="project.members && project.members.length" class="grid grid-cols-9 gap-1 rounded-xl mt-2">
                <div v-for="(employee, index) in project.members.slice(0, 9)" :key="index">
                  <div v-if="employeesByEmail[employee]">
                    <img :src="employeesByEmail[employee].fotolink" class="rounded" width="28" height="28">
                  </div>
                </div>
              </div>
            </div>
        </div>
      </template>
    </div>
  </div>
</template>
